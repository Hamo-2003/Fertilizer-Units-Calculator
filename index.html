<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>أداة حساب وحدات السماد</title>
<style>
  body { font-family: 'Cairo', sans-serif; background: #f7f7f7; margin: 20px; }
  .glowing-name {
    color: #fff;
    text-shadow: 0 0 5px #ff6600, 0 0 10px #ff6600, 0 0 15px #ff6600;
    animation: glow 1.5s ease-in-out infinite alternate;
  }
  @keyframes glow {
    from { text-shadow: 0 0 5px #ff6600, 0 0 10px #ff6600, 0 0 15px #ff6600; }
    to { text-shadow: 0 0 10px #ff6600, 0 0 20px #ff6600, 0 0 30px #ff6600; }
  }
  header, footer { text-align: center; padding: 10px; font-weight: bold; color: #ff6600; }
  .lang-switch { position: absolute; top: 10px; left: 10px; }
  .container { background: white; padding: 20px; border-radius: 16px; box-shadow: 0 0 10px #ccc; }
  button { padding: 10px 15px; margin: 5px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; }
  .export { background: #007bff; color: white; }
  .print { background: #28a745; color: white; }
</style>
</head>
<body><div class="lang-switch">
  <select id="language" onchange="switchLanguage()">
    <option value="ar">العربية</option>
    <option value="en">English</option>
  </select>
</div><header>⚡ تصميم <span class="glowing-name">م. محمد صبحي</span> ⚡</header><div class="container">
  <h2 id="title">حاسبة وحدات العناصر من الأسمدة</h2><label id="fertLabel">اختر السماد:</label> <select id="fertilizer"></select>

<br><br> <label id="unitLabel">أدخل عدد الوحدات المطلوبة:</label> <input type="number" id="units" />

<button id="calculateBtn" onclick="calculate()">حساب</button>

  <h3 id="result"></h3><button id="exportCSVBtn" class="export" onclick="downloadCSV()">تصدير CSV</button> <button id="exportExcelBtn" class="export" onclick="downloadExcel()">تصدير Excel</button> <button id="printBtn" class="print" onclick="window.print()">طباعة</button>

</div><footer>⚡ Created by <span class="glowing-name">ENG. Mohamed Sobhy</span> ⚡</footer><script>
const FERTILIZERS_DATA = [
  { en: "Urea 46% N", ar: "يوريا 46% ن", ratios: { N: 46 } },
  { en: "Ammonium Nitrate 33.5% N", ar: "نترات الأمونيوم 33.5% ن", ratios: { N: 33.5 } },
  { en: "Ammonium Sulfate 20.5% N", ar: "كبريتات الأمونيوم 20.5% ن", ratios: { N: 20.5 } },
  { en: "Calcium Nitrate 15.5% N", ar: "نترات الكالسيوم 15.5% ن", ratios: { N: 15.5 } },
  { en: "Nitric Acid 60% N", ar: "حمض النيتريك 60% ن", ratios: { N: 60 } },
  { en: "MAP 12-61-0", ar: "فوسفات أحادي الأمونيوم 12-61-0", ratios: { N: 12, P: 61 } },
  { en: "DAP 18-46-0", ar: "فوسفات ثنائي الأمونيوم 18-46-0", ratios: { N: 18, P: 46 } },
  { en: "MKP 0-52-34", ar: "فوسفات أحادي البوتاسيوم 0-52-34", ratios: { P: 52, K: 34 } },
  { en: "NPK 20-20-20", ar: "مركب 20-20-20", ratios: { N: 20, P: 20, K: 20 } },
  { en: "Urea Phosphate 17-44-0", ar: "فوسفات اليوريا 17-44-0", ratios: { N: 17, P: 44 } },
  { en: "Mono-Ammonium Phosphate 12-51.5-0", ar: "فوسفات أحادي الأمونيوم 12-51.5-0", ratios: { N: 12, P: 51.5 } },
  { en: "Di-Ammonium Phosphate 19.5-55-0", ar: "فوسفات ثنائي الأمونيوم 19.5-55-0", ratios: { N: 19.5, P: 55 } },
  { en: "Single Super Phosphate 0-15.5-0", ar: "سوبر فوسفات أحادي 0-15.5-0", ratios: { P: 15.5 } },
  { en: "Triple Super Phosphate 0-46-0", ar: "سوبر فوسفات ثلاثي 0-46-0", ratios: { P: 46 } },
  { en: "Phosphoric Acid 85% P", ar: "حمض الفوسفوريك 85% ف", ratios: { P: 85 } },
  { en: "Potassium Sulfate 0-0-48", ar: "كبريتات البوتاسيوم 0-0-48", ratios: { K: 48 } },
  { en: "Potassium Chloride 0-0-61", ar: "كلوريد البوتاسيوم 0-0-61", ratios: { K: 61 } },
  { en: "Potassium Nitrate 13-0-44", ar: "نترات البوتاسيوم 13-0-44", ratios: { N: 13, K: 44 } }
];

function loadFertilizers() {
  const select = document.getElementById("fertilizer");
  select.innerHTML = ''; // Clear existing options
  const lang = document.getElementById("language").value;

  FERTILIZERS_DATA.forEach((fert) => {
    const option = document.createElement("option");
    option.value = fert.en; // Use English name as value for consistent lookup
    option.textContent = lang === 'ar' ? fert.ar : fert.en;
    select.appendChild(option);
  });
}

function getFertilizerRatios(name) {
  const fert = FERTILIZERS_DATA.find(f => f.en === name);
  return fert ? fert.ratios : null;
}

function calculate() {
  const fertNameEn = document.getElementById("fertilizer").value;
  const units = document.getElementById("units").value;
  const lang = document.getElementById("language").value;

  const ratios = getFertilizerRatios(fertNameEn);
  if (!ratios) {
    document.getElementById("result").textContent = lang === 'ar' ? "خطأ: لم يتم العثور على بيانات السماد." : "Error: Fertilizer data not found.";
    return;
  }

  // Use the first ratio found (N, P, or K) for calculation as per original logic
  const percent = Object.values(ratios)[0];
  const kg = (units / (percent / 100)).toFixed(2);

  const fertNameDisplay = FERTILIZERS_DATA.find(f => f.en === fertNameEn)[lang];

  let resultText;
  if (lang === "en") {
    resultText = `You need ${kg} kg of ${fertNameDisplay} fertilizer`;
  } else {
    resultText = `تحتاج إلى ${kg} كجم من سماد ${fertNameDisplay}`;
  }
  document.getElementById("result").textContent = resultText;
}

function downloadCSV() {
  let data = document.getElementById("result").textContent;
  let blob = new Blob([data], { type: 'text/csv' });
  let url = URL.createObjectURL(blob);
  let a = document.createElement('a');
  a.href = url;
  a.download = 'fertilizer_result.csv';
  a.click();
}

function downloadExcel() {
  let data = document.getElementById("result").textContent;
  let blob = new Blob([data], { type: 'application/vnd.ms-excel' });
  let url = URL.createObjectURL(blob);
  let a = document.createElement('a');
  a.href = url;
  a.download = 'fertilizer_result.xls';
  a.click();
}

function switchLanguage() {
  const lang = document.getElementById("language").value;

  if (lang === "en") {
    document.body.dir = "ltr";
    document.getElementById("title").textContent = "Fertilizer Nutrient Unit Calculator";
    document.getElementById("fertLabel").textContent = "Select fertilizer:";
    document.getElementById("unitLabel").textContent = "Enter required units:";
    document.getElementById("calculateBtn").textContent = "Calculate";
    document.getElementById("exportCSVBtn").textContent = "Export CSV";
    document.getElementById("exportExcelBtn").textContent = "Export Excel";
    document.getElementById("printBtn").textContent = "Print";
  } else {
    document.body.dir = "rtl";
    document.getElementById("title").textContent = "حاسبة وحدات العناصر من الأسمدة";
    document.getElementById("fertLabel").textContent = "اختر السماد:";
    document.getElementById("unitLabel").textContent = "أدخل عدد الوحدات المطلوبة:";
    document.getElementById("calculateBtn").textContent = "حساب";
    document.getElementById("exportCSVBtn").textContent = "تصدير CSV";
    document.getElementById("exportExcelBtn").textContent = "تصدير Excel";
    document.getElementById("printBtn").textContent = "طباعة";
  }
  loadFertilizers(); // Reload fertilizer list with correct language
}

loadFertilizers();
switchLanguage(); // Apply initial language settings
</script></body>
</html>
